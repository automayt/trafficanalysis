## https://www.malware-traffic-analysis.net/2018/CTF/2018-CTF-from-malware-traffic-analysis.net-2-of-2.pcap.zip
pass: infected

LAN SEGMENT PROPERTIES:  

LAN segment: 172.17.1.0/24 (172.17.1.0 through 172.17.1.255)  
Domain: kyivartworks.com  
Domain controller: 172.17.1.2 - Kyivartworks-DC  
LAN segment gateway: 172.17.1.1  
LAN segment broadcast address: 172.17.1.255  
Windows client to investigate: 172.17.1.129  
TASKS I SUGGESTED:  
___
**we'll wrap both of these into the same query**  
What is the MAC address of the Windows client at 172.17.1.129?  
What is the host name for the Windows client at 172.17.1.129?  
**00:1e:67:4a:d7:5c	Nalyvaiko-PC**
```
index=zeek sourcetype="bro:dhcp:json" client_addr="172.17.1.129" 
|  table mac host_name
```
___
Based on the Kerberos traffic, what is the Windows user account name used on 172.17.1.129?  
**innochka.nalyvaiko**
```
index=zeek sourcetype="bro:kerberos:json" "id.orig_h"="172.17.1.129" 
| dedup client | table client
```
___
What URL in the pcap returned a Microsoft Word document?
**ifcingenieria.cl:80/QpX8It/BIZ/Firmenkunden/**

The slower way, but more analysis focused way would be;  
`index=zeek | stats count by mime_type` -> discover the mime_type "application/msword" and pivot to it.  
vvv  
`index=zeek uid=CBlTHWIhc8txaE0M5 sourcetype="bro:http:json" | table url` -> the uid came from the "conn_uids" field in files.log.  

The more streamlined (though maybe prone to error) way would be to use a subsearch. If the mime_type isn't correct, it could miss it;  
```
index=zeek sourcetype="bro:http:json"
    [ search index=zeek mime_type="application/msword" 
    | rename conn_uids as uid 
    | table uid] 
| table url
```

When did the URL happen? (date and time in UTC)  
How many bytes is the Word document returned from that URL?  
What is the SHA256 of the Word document returned from that URL?  
What URL in the pcap returned a Windows executable file?  
How many bytes is the Windows executable file returned from that URL?  
What is the SHA256 of the Windows executable file returned from that URL?  
What type of infection occurred in this pcap?  
In addition to HTTP post-infection traffic, what other type of post-infection traffic is generated by the infected Windows host?  
  
